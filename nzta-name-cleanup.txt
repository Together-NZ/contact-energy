# Clean up NZTA EV data where some town names  having appended with post code values. 
nzta_ev_df = pd.read_excel(r'G:\My Drive\together_projects\volvo\nzta-ev-dataset-2025.xlsx')


# Iterate over each row in the DataFrame
for index, row in nzta_ev_df.iterrows():
    # Check if the town column has an alphanumeric value
    if any(char.isdigit() for char in row['town']):
        # Extract the number part and remove it from the alphabetic value
        town = ''.join(filter(str.isalpha, row['town']))
        tmp_postcode = ''.join(filter(str.isdigit, row['town']))
        
        # Update the town column
        nzta_ev_df.at[index, 'town'] = town
        
        # Check if the post_code column is null or 0
        if pd.isnull(row['post_code']) or row['post_code'] == 0:
            # Assign tmp_postcode to post_code
            nzta_ev_df.at[index, 'post_code'] = tmp_postcode


nzta_ev_df.to_csv("d:/downloads/nzta-ev1.csv")

======